<template name="editPassword">

    {{#if updatePasswordComplete}}
        <div class="small-padding">{{>encryptionLoader tasks=updatePasswordComplete}}</div>

    {{else}}
        <form action="#" id="editPasswordForm">
            <div class="row no-margin">
                <div class="input-field col s12 relative">
                    <i class="material-icons prefix  main-color">security</i>
                    <input id="oldPassword" type="password"
                           class=" {{#if compare errors.oldPassword '==' 'valid'}}valid {{else }}{{#if
                                   errors.oldPassword.length}}invalid{{/if}}{{/if}}">
                    <label for="oldPassword">{{__ '.oldPassword'}}</label>
                    <div class="formErrorContainer">
                        {{#if isArray  errors.oldPassword}}
                            {{#each error in errors.oldPassword}}
                                <div class="formError danger-color">
                                    {{error}}
                                </div>
                            {{/each}}
                        {{/if}}
                    </div>

                </div>
            </div>
            <div class="flex">
                <div class="flex-auto">
                    <div class="row no-margin">
                        <div class="input-field col s12">
                            <i class="material-icons prefix main-color">security</i>
                            <input id="newPassword" type="password"
                                   class=" {{#if compare errors.newPassword '==' 'valid'}}valid {{else }}{{#if
                                           errors.newPassword.length}}invalid{{/if}}{{/if}}">
                            <label for="newPassword">{{__ '.newPassword'}}</label>
                            <div class="formErrorContainer">
                                {{#if isArray errors.newPassword}}
                                    {{#each error in errors.newPassword}}
                                        <div class="formError danger-color">
                                            {{error}}
                                        </div>
                                    {{/each}}
                                {{/if}}
                            </div>
                        </div>
                    </div>
                    <div class="row no-margin">
                        <div class="input-field col s12">
                            <i class="material-icons prefix  main-color">verified_user</i>
                            <input id="newPasswordRepeat" type="password"
                                   class=" {{#if compare errors.newPasswordRepeat '==' 'valid'}}valid {{else }}{{#if
                                           errors.newPasswordRepeat.length}}invalid{{/if}}{{/if}}">
                            <label for="newPasswordRepeat">{{__ '.repeatPassword'}}</label>
                            <div class="formErrorContainer">
                                {{#if isArray  errors.newPasswordRepeat}}
                                    {{#each error in errors.newPasswordRepeat}}
                                        <div class="formError danger-color">
                                            {{error}}
                                        </div>
                                    {{/each}}
                                {{/if}}
                            </div>
                        </div>
                    </div>
                </div>
                {{#if passwordStrength.strength}}
                    <div class="circle-container  tooltipped"
                         style=" {{#if
                                 isPhone}}width: 60px; padding-top: 40px {{else}}width: 100px ; padding:20px;{{/if}}">
                        <p class="center-align  minus-color " style="font-size: 1em ; margin: 0">{{__ '.strength'}}
                            :</p>
                        <div class="center-align  progress--circle progress--{{passwordStrength.progress}}"
                             style="margin: 5px 0px !important;">
                            <div class="progress__number {{#if compare passwordStrength.strength '>='
                                                               10}} green-text text-darken-2 strong{{else}}red-text text-darken-2{{/if}}">{{passwordStrength.strength}}
                                /10
                            </div>
                        </div>
                        <!--<p  class="center-align no-margin"><b class="focus-color">minimum : 10</b></p>-->
                    </div>
                {{/if}}
            </div>
            {{#if compare showSecurize }}
                <div class="row" style="margin-top: 10px">
                    <div class="col s12">
                        <div class="flex ">
                            <i class="material-icons lockIcon">vpn_key</i>
                            <p class="sectionLabel flex-auto no-margin tooltipped" data-position="top"
                               data-delay="50" data-tooltip="{{__ "signinForm.securizeInfo"}}">{{__
                                    "signinForm.securized"}}</p>
                            <div class="checkBoxContainer {{#if forceSecurize}}tooltipped forceSecurize{{/if}}"
                                 data-position="top"
                                 data-delay="50" data-tooltip="{{__ ".forceSecurize"}}">
                                <p style="">
                                    <input securizedSwitch type="checkbox" id="securizedSwitch">
                                    <label for="securizedSwitch"></label>
                                </p>
                            </div>

                        </div>
                    </div>
                </div>
                {{#unless isSubmitable}}
                    <div class="row no-margin">
                        <div class="col s12">
                            <div class="row">
                                <div class="col s12">
                                    <p class="infoQuotes">
                                        {{__ ".forceSecurize"}}
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                {{/unless}}
            {{/if}}

            <div class="row center-align" style="margin: 15px 0 0 0">
                {{#if isSubmitable}}
                    <button href="#" class="btn btnFocus center-align waves-effect waves-light shadow "><i
                            class="material-icons right">account_circle</i>{{__ '.editPassword'}}
                    </button>

                {{/if}}
            </div>
        </form>
        {{#if securizeModal}}
            <div class="securizeModalBg" closeSecurizeModal>
            </div>
            <div id="securizeEditModal" class="shadow">
                <a href="" class="btn btn-floating waves-light waves-effect" closeSecurizeModal><i
                        class="material-icons">clear</i></a>
                <div class="row no-margin">
                    <div class="col s12">
                        <p class="center-align"><i class="material-icons focus-color">vpn_key</i>{{__
                                "signinForm.securizeTitle"}}</p>
                    </div>
                    <hr class="hr">
                </div>
                <div class="row">
                    <div class="col s12">
                        <h6 class="">
                            {{__ "signinForm.securizedpasswordInfos"}}
                        </h6>
                        <div class="flex pwnedResults">


                            {{#if compare verifiedPassword "==" "verified"}}
                                <div class=""><i class="material-icons green-text">done</i></div>
                                <div class="pwnedResult green-text">{{__ "signinForm.pwnedSuccess"}}</div>
                            {{/if}}
                            {{#if compare verifiedPassword ">" 0}}
                                <div class=""><i class="material-icons danger-color">clear</i></div>
                                <div class="pwnedResult danger-color">{{__
                                        "signinForm.pwned"}} {{verifiedPassword}} {{__
                                        "signinForm.times"}}<br><a href="" class="link center-align"
                                                                   closeSecurizeModal>{{__
                                        "signinForm.changeAndRetry"}}</a></div>

                            {{/if}}
                            {{#if compare verifiedPassword "==" "error"}}
                                <div class=""><i class="material-icons danger-color">clear</i></div>
                                <div class="pwnedResult danger-color">{{__ "signinForm.pwnedError"}}</div>
                            {{/if}}
                            {{#if compare verifiedPassword "==" "waiting"}}
                                <div class="progress">
                                    <div class="indeterminate"></div>
                                </div>
                            {{/if}}
                        </div>
                    </div>
                </div>
                {{#if compare verifiedPassword "==" "verified"}}
                    <div class="row">
                        <div class="col s12">
                            <h6>{{__ "signinForm.pinCode"}}</h6>
                            <p class="infoQuotes">{{__ "signinForm.keyboardInfo"}}</p>
                        </div>

                        {{>virtualKeyboard parentInstance = parentInstance pinCode=pinCode}}

                    </div>
                {{/if}}
                <div class="row">
                    <div class="col s6"><a href="" class="btn btn-danger full-width waves-effect waves-light"
                                           closeSecurizeModal>{{__
                            "signinForm.return"}}</a></div>
                    {{#if compare (compare verifiedPassword "==" "verified") "&&" (compare pinCode.length "==" 4) }}
                        <div class="col s6"><a href="" class="btn btnStandard full-width waves-effect waves-light"
                                               validateSecurize>{{__
                                "signinForm.validate"}}</a></div>

                    {{/if}}
                </div>
            </div>
        {{/if}}
    {{/if}}
</template>
